# This test checks for behavior when loading data from the config file is
# combined with the --bundle option. We expect this should break during
# bundle merging, since no bundle roots have been explicitly configured.

! exec eopa test --bundle ./testdir
stderr '^detected overlapping roots in bundle manifest'
stderr '.*warning.*'
stderr '.*additional data paths picked up from config file, this is likely to cause an overlapping roots error.*'

-- testdir/test1.rego --
package testpkg
test_data_access_1 {
	"abc" == data.foo.bar
}
test_data_access_2 {
	"quux" == data.coolstuff.foobar
}
-- niftydir/dummy1.rego --
package foo
bar := "abc"
-- cooldir/dummy2.rego --
package coolstuff
foobar := "quux"
-- .styra.yaml --
data:
  ./niftydir
  ./cooldir
