! exec eopa lint --no-color policies/
! stderr .
stdout 'Rule:\s+opa-fmt'
stdout 'Description:\s+File should be formatted with `opa fmt`'
stdout 'Category:\s+style'
[windows] stdout 'Location:\s+policies\\test.rego'
[!windows] stdout 'Location:\s+policies/test.rego'
stdout 'Documentation:\s+https://www\.openpolicyagent\.org/projects/regal/rules/style/opa-fmt'
stdout '1 file linted\. 2 violations found\.'

exec eopa lint policies_pass
! stderr .
stdout '1 file linted\. No violations found\.'

exec eopa lint policies_sql
! stderr .
stdout '1 file linted\. No violations found\.'

-- policies/test.rego --
package policies.test
import rego.v1
allow := true
-- policies_pass/this_doesnt_matter.rego --
package policies_pass

import rego.v1

allow := true
-- policies_sql/policies/sql/sql.rego --
package policies.sql

import rego.v1

allow if {
	some res
	sql.send({}, res)
	count(res.rows) > 1
}
